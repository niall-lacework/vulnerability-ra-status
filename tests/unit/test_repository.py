from vulnerability_ra_status import repository


def test_can_get_repo_file_contents(gh_token):
    repo = repository.GithubRepo(owner='lacework-dev', repo='helm3-platform',
                                 access_token=gh_token)
    file_contents = repo.get_file_contents('config/prodn1/labels.yaml')

    assert file_contents is not None


def test_can_get_repo_commits(gh_token):
    repo = repository.GithubRepo(owner='lacework-dev', repo='vuln-eval',
                                 access_token=gh_token)
    commits = repo.get_commits()
    assert len(commits) > 0
    assert commits.get(
        '21f4837d9c45290d894ecefe2e2691e646fc80ba') == len(commits) - 1
